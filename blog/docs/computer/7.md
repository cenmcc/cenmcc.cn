# 第七章 网络管理技术

### 网络管理

- 网络管理的发展历史：网络管理理论和技术是随着计算机、通信等学科的理论和工程技术的发展而发展的。一方面网络管理技术适应了现有网络的管理需求；另一方面，网络的发展又反过来促进了网络管理研究和技术的发展。

- 网络管理的主要任务有两个：

  1. 对网络的状态进行监测
  2. 对网络的运行进行控制

- 网络管理的目标：网络管理的根本目标是最大限度地满足网络管理者和网络用户对计算机网络的有效性、可靠性、开放性、综合性、安全性和经济性的要求。

- 网络管理的对象：**硬件资源和软件资源**

  - 硬件资源是指物理介质、计算机设备和网络互连设备。
  - 软件资源主要包括操作系统、应用软件和通信软件。
  - 被管对象的集合称为**管理信息库MIB**，网络管理系统的实现主要依靠MIB作为基础。

- 网络管理的体系结构：

  - 概念：ISO提出基于远程监控的管理框架是现代网络管理体系结构的核心。在远程监控的管理框架下，OSI参考模型提出以一对相互通信的系统管理实体为核心，使管理进程与一个远程系统相互作用，实现对远程资源进行控制的网络管理系统体系结构。

  - 一个完整的网络管理系统主要包括了4部分：

    - **网络管理站**（或管理进程）：网络管理站和管理代理通过**交换管理信息**来进行工作，信息分别驻留在被管设备和管理站的管理信息库中，信息交换通过网络管理协议来实现。具体的交换过程是通过协议数据单元进行。

    - **管理代理**（或代理）：管理代理具有两个基本功能，一是从管理信息库MIB中读取各种变量值；二是在MIB中修改各种变量值。

    - **网络管理协议NMP**：最为广泛的网络管理协议是**基于TCP/IP模型的简单网络管理协议SNMP**和**基于OSI模型的公共管理信息服务/公共管理信息协议CMIS/CMIP**。<u>其中SNMP应用最多，使用**UDP**传输</u>，成为事实上的工业标准。

    - **管理信息库MIB**：管理信息库MIB是一个信息存储库，用于存放与被管对象相关的网络信息。MIB中的对象按层次进行分类和命名，整体表示为一种树形结构。

      管理信息库是一个逻辑结构，其数据可以分为3类。

      1. 结构数据
      2. 动态数据
      3. 控制数据

      - 被管对象图示，通过index 【1.3.6.1.2.1】可以找到mib-2

      ![](https://yipei-pub-test.oss-cn-zhangjiakou.aliyuncs.com/42f980203ff65061a02a3f4241e5a19d.png)

- 网络管理的模式：网络管理模式分为**集中式网络管理模式**、**分布式网络管理模式**和**混合管理模式**3种。

  1. 集中式网络管理模式：集中式网络管理模式是目前使用最普遍的一种模式。 
     - **局限性**：
       1. 容易产生拥塞现象
       2. 功能固定、不灵活
       3. 不可靠性
       4. 传输中的瓶颈
  2. 分布式网络管理模式：将管理信息合理地分布到网络各处，使管理变得更加自动化， 在最靠近问题源的地方能够做出基本的决策。
  3. 混合管理模式：混合管理模式是集中管理模式和分布式管理模式相结合的产物，集中式和分布式管理模式分别适用于不同的网络环境，各有优缺点。

- 网络管理的功能：

  - ISO对网络管理功能给出了定义，并被各个网络管理软件制造商所接受。

  - 功能：主要包括5个方面的功能**：故障管理、配置管理、安全管理、性能管理**和**计费管理**。

    - 性能管理：**性能检测**和**网络控制**。

    - 计费管理方式：按网络流量计费，使用时间计费，网络服务计费。



#### 简单网络管理协议SNMP

- 定义：SNMP是一系列网络管理规范的集合，包括**SNMP协议**、 **管理信息数据库MIB**和**管理信息结构SMI**共3部分。

  - SNMP协议规定了管理站和代理间交换网络管理信息的报文格式，报文中包含了代理中的对象及其状态；

  - MIB是被管对象的集合；

  - SMI定义了SNMP所用信息的组织、组成和标识，规定了 MIB中被管对象的数据类型及其表示和命名方法。

- SNMP采用**管理站--管理代理**模型，如下图所示。

  ![](https://yipei-pub-test.oss-cn-zhangjiakou.aliyuncs.com/d40a4c36a9de6d9931bf9e3af698a1e2.png)

- 基本工作原理

  1. SNMP管理站和管理代理之间的操作有3种 Get ， Set， Trap(出现异常、想管理站报告问题)。
  2. SNMP为应用层协议，使用传输层的UDP协议传输。
  3. 每个代理管理若干对象，并与管理代理建立共同体关系，共同体名是全局标识符，作为认证手段。
  4. 代理设备和管理站必须实现TCP/IP协议。

- SMI的主要作用有以下3个：

  1. 规定了被管对象的命名法则，所有被网管的对象都在对象命名树上。mib-2子树下是SNMP网管对象。 从树根到树叶的编号串联起来，用"."分隔，形成被管对象的全局标识。如mgmt对象：1.3.6.1.2

  2. 规定了被管对象的数据类型：**ASN.1**

     - 数据类型：简单类型和结构化类型

     - 简单类型：INTEGER、Unsigned 、OCTET STRING、OBJECT IDENTIFIER、 IPAdress

     - 结构化类型： sequence（结构体）， sequence of（数组）

  3. 规定了被管对象数据的编码方法

     采用ASN.1制定的基本编码规则，对被管对象进行数据编码。编码后就可以在网络中传输。

     - T字段：数据类型；L字段：表示V字段的长度；V字段：数据的取值。

     - T字段：类别段（2bit）+   格式段（1bit）＋   编号段（5bit）
     - L字段：当为一个字节时，最高位为0，后7bit表示V字段数据长度。当为多字节时，最高位为1，后面7bit表示后续字节数目，然后用后面字节定义V字段数据长度。

     | T字段 | L字段(可变) | V字段(可变) |
     | ----- | ----------- | ----------- |

  

#### 管理信息库MIB

- 定义：在基于TCP/IP参考模型的管理系统中，包含有关被管理资源及元素信息的数据库，被称为管理信息库MIB。管理信息库保存和维护着可供管理程序读写的控制和状态信息。管理程序通过对MIB中信息的值进行读取和重置实现对网络的管理。只有 MIB中的对象才能被SNMP协议所管理。



#### SNMP

- **SNMP协议报文**

  - 定义：SNMP通过交换SNMP报文来传递管理信息。每个报文都是完整和独立的，使用UDP数据报进行传送。

  - 组成：一个SNMP报文由：版本号、首部、安全参数和SNMP报文数据4 部分组成

    - 版本号：SNMP协议版本
    - 首部：报文标识，最大报文段长度，报文标志
    - 安全参数：报文摘要MD

    | 版本号 | 首部 | 安全参数 | SNMP报文类型 |
    | ------ | ---- | -------- | ------------ |

- **SNMP报文数据部分**的格式比较复杂，如图所示。

  加密字段：加密时使用

  PDU类型：表明SNMP协议携带数据报文的类型，8中类型。

  请求标识：管理站设置，管理代理在相应报文中要复制此标识。

  差错控制：管理代理的相应报文，用来报告差错。

  | 加密字段 | PDU类型 | 请求标识符 | 差错状态 | 差错索引 | 变量绑定 |
  | -------- | ------- | ---------- | -------- | -------- | -------- |

- SNMP工具

  1. SNMP MIB浏览器

  2. SNMP命令行工具：snmputil.exe

  3. SNMP Sniff工具



#### 网络管理系统

- 概念：网络管理系统是实现管理网络功能，保障网络正常运行的软、 硬件组成的综合系统。由网络管理系统软件和网络设备组成。
- **网络管理系统应当具备的特点**：
  1. 具有全面监控网络性能的能力。
  2. 具有主动和预警管理的功能。
  3. 支持全网联动。
  4. 具有对资源进行有效管理的能力。
  5. 具有服务质量管理功能。
- 发展趋势
  1. 开放性：开放式的管理接口可以使网络管理软件能够管理他厂商的网络管理设备，增加网络的适应性和灵活性。
  2. 综合性：通过一个统一的系统平台实现对多个互联网络的管理。
  3. 智能化：网络管理系统可以自动地探测网络环境、定时监网络运行状态、发现网络故障，以及定位并排除网络故障等
  4. 安全性
  5. 基于B/S结构的管理：提高系统的跨平台性，提高系统的体验。
- 软件
  - OpenView：HP开发的网络管理软件
  - TiVoli NetView：IBM开发的网络管理综合平台 • Cisco Works
  - CiscoWorks是由Cisco公司专门为小型和中型网络开发的一套基于PC的集成式网络配置和诊断工具。
  - Cacti：Cacti是一种基于PHP，MySQL， SNMP及RRDTooI开发的网络流量监测图形分析工具，Cacti是通过SNMP中的Get方式来获取网络管理数据，使用RRDtool工具绘制图形。（开源的）







