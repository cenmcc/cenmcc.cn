# 第四章 项目估算

### 项目估算的挑战

软件成本及工作量估算永远不会是一门精确的科学。太多的变化——人员、技术、环境、策略—影响了软件的最终成本及开发所需的工作量。无论何时进行估算，我们都是在预测未来， 都会有某种程度的不确定性。虽然估算是一门科学，但它更像一门艺术。所以，当我们在选择一个项目经理时，我们会思考：什么能力对项目经理是最重要的？专家给出的答案是：在问题发生之前就能预测问题的一种能力。

对于有很大不确定性的软件项目，仅有预测未来的能力是不够的，项目经理还需要有预测的勇气，在项目还是一团迷雾的时候就开始估算工作。

在软件项目开始时，事情总是有某种程度的模糊不清。估算一个软件开发工作的资源、成本及进度需要经验，需要了解历史数据，同时，也需要一种勇气去面对估算所带来的风险。估算伴随着与生俱来的风险，这种风险可能来源于项目的复杂性和不确定性。

•复杂性和不确定性是相对过去经验而言的。在同样领域工作过很长时间，这种复杂性和不确定性就会降到很低，而对于一个陌生的领域，这种复杂性和不确定性会被放大。

•复杂性和不确定性来源于软件规模。软件规模越大，复杂性越高、不确定性就越大。因为随着规模的增长，软件中各个元素之间的相互依赖性也迅速增加，接口关系变得错综复杂。规模越大，估算的误差就会越大，会带来更大的不确定性。

需求的不确定性也会对估算的风险产生影响，所以，在项目管理中，对需求变更的控制和管理是重中之重。这种需求主要指产品的质量需求和用户需求，包括产品的功能性需求和非功能性需求。



### 项目估算的基本内容

项目估算是针对软件开发项目的规模、工作量、成本、进度

等进行估算，这些估算是发生在项目实施之前，即在计划过程中

完成。项目估算是基于历史数据、经验和一定的方法来完成的， 由项目的目标、工作范围、产品规模、业务逻辑和采用的技术等决定。

（1） 规模估算（size estimation）：以代码行数、功能点数、对象点或特征点数等来对软件项目所开发的产品进行估算。

软件规模估算是工作量估算、进度估算的基础，也有助于编制合理的成本预算、人力资源计划。

（2） 工作量估算（workload estimation）：将任务分解并结合人力资源水平来估算，合理地分配研发资源和人力，获得最高的效率比。工作量估算是在软件规模估算和生产率估算的基础上进行的。

（3）进度估算（schedule estimation）：通过任务分解、 工作量估算和有效资源分配等对项目可能实施的进度给出正确的评估。

（4）风险估算（risk estimation）：一般通过两个参数一 “风险发生的概率”和“风险发生后所带来的损失”来评估风险。

（5）其他估算：如需求稳定性或需求稳定因子、资源利用效率、文档复审水平、问题解决能力代码动态增长等。

在项目估算中，我们首先会考虑软件规模估算的问题。因为

规模是软件项目量化的结果，或者说，“软件规模在很大程度上代

表了项目范围的大小，所以，项目估算的好坏取决于项目工作规模的估算，规模估算是项目计划者面临的第一个挑战。其次，需要设法将规模估算转换成工作量，这种转换没有现成的公式，依赖于历史数据、工程环境和生产力数据-项目组人员的能力，需要不断积累数据和经验，逐渐形成可靠的估算公式。

### 软件规模估算

软件估算方法有很多种，可以分为直接方法和间接方法，如软件规模估算的直接方法有代码行（Iines of code，LOC）估算法，而间接方法有功能点方法等。由于事先缺乏足够的数据来准确预估代码行，所以人们往往会采用间接的方法。软件规模估算方法，也可以分为以下几类。

#### 基本估算方法

（1）分解方法，采用“分而治之”的策略，对软件项目进行分解，将复杂问题转化为简单的问题，将整个项目分解成若干主要的功能及相关的软件工程活动，然后针对简单项（单个功能或单个活动）采用逐步求精的方式进行估算，最后通过累加获得整体的估算结果。

（2） 算术模型（Algorithmic Models）法，通过估算模型 （即带有多个变量的函数）来估算，如COCOMO模型、功能点分析 (Function Points Analysis。 FPA）、特征点（Feature Point）、对象点（Object Point）、Bang估算（DeMarco‘s Bang Metric）、模糊逻辑（Fuzzy Logic）、标准构件法 （Standard Component）以及IBM定量影响因子（Quantitative Influencing Factors， QIF）估算模型等。

（3） 专家判断（Expert judgment）或经验法，如德尔菲法 （Delphi technique）。估算的人应有专门知识和丰富的经验， 据此提出一个近似的数字。但这种方法的可靠性和准确度都比较低，适合于快速拿出一个初步估算，而不适合进行详细的估算。

（4）比例法是比较科学的一种传统估算方法，是基于类比的估算技术，根据过去类似的项目，直接进行类比获得当前项目的估算结果。

软件项目估算，常常采用分解技术，有时会根据历史数据所获得的经验模型来进行估算，但很难用一个公式、一步就能获得项目的估算结果，所以经验模型可用于补充分解技术，并提供一种潜在有价值的估算方法。理想情况下，使用这两种技术对项目进行估算，可以进行相互验证和需。例如，通过不同的方法可以获得估算的乐观值、悲观值和平均值，然后基于这3个值获得最后的估算值。

估算值  =（乐观值+4X平均值+悲观值）/ 6

自动估算工具可以实现一种或多种分解技术或经验模型，而且可以让专家或项目经理参与这个估算过程，和自动估算系统实现交互式处理，以获得更霍需的结果。但许多估算都依赖历史数据，没有历史数据存在，规模、成本等各种估算难以实施。

在分解技术中，WBS方法是最常用的方法，而且WBS方法不局限于软件产品的功能分解，也可以扩展到非功能特性以及其他软件任务的分解上，从而满足所有的功能和非功能性需求。一个典型的项目由子项目或多个阶段（Phase）组成（如需求分析阶段、 架构设计阶段等），每一个阶段由多个相互关联的活动 （Activity）构成，而每个活动又可能细分为多个任务（Task）。

功能分解的目的并不是为系统定型，而是为了更好地理解和沟通系统，即完成软件项目工作范围的详细说明。

为了详细地估算出项目WBS每一层级元素（即项目、阶段、 活动和任务）的工作量，实际有两个模式可以应用，即自顶向下估算模式和自底向上估算模式。

•自顶向下估算模式，首先估算出项目一级的工作量，然后层层往下分摊，把上一层工作量分摊到下一层的阶段、活动或任务。通常使用FPA方法或COCOMO II 来估算项目一级的工作量。

•自底向上估算模式，要求先估算出底层任务一级（如果没有任务，则为活动）的工作量，然后层层向上汇总到活动、阶段和项目级。通常使用QIF估算方法或专家判断来估算项目低层WBS 元素的工作量。

WBS方法的使用，是建立在对项目范围掌控的基础之上的， 而WBS方法的应用结果又能使我们对项目范围的理解更透彻。WBS 方法和项目范围掌控之间是相辅相成的关系，两者不断推进的结果就是清楚定义项目范围。所以，在采用WBS方法之前，需要和用户进行充分的沟通，获得足够的信息以了解项目范围。

与用户沟通的常用方法有书面调查、电子问卷、会议或访谈等。书面调查和电子问卷方法简单，投入成本低。使用匿名调查方式，容易获得用户更真实的想法。但书面调查和电子问卷方法不容易挖掘深层次的信息，也不能获得及时反馈，信息量也不够。会议或访谈方法则能弥补书面调查和电子问卷方法的不足，获得准确/足够多的信息。

### 软件规模估算

工作量估算和软件规模估算息息相关，或者说，工作量估算是建立在软件规模估算的基础之上的。在软件估算过程中，还包括人力资源估算、进度估算等，完成这些估算，是软件计划的最重要工作内容之一。一旦良好地完成这些估算，就能为后期软件项目的实施打下坚实的基础。

#### 4.1 德尔菲法

德尔菲法（Delphi technique）是一种专家评估技术，适用于在没有或没有足够历史数据的情况下，来评定软件采用不同的技术或新技术所带来的差异，但专家的水平及对项目的理解程度是工作中的关键点。单独采用德尔菲法完成软件规模的估算有一定的困难，但对决定其他模型的输入（包括加权因子）时特别有用，所以在实际应用中，一般将德尔菲法和其他方法结合起来使用。德尔菲法鼓励参加者就问题进行相互的、充分的讨论，其操作的步骤如下。

（1） 协调人向各专家提供项目规格和估算表格。

（2） 协调人召集小组会和各专家讨论与规模相关的因素。

（3）各专家匿名填写迭代表格。

（4）协调人整理出一个估算总结，以迭代表的形式返回给专家。

（5）协调人召集小组会，讨论较大的估算差异。

（6） 专家复查估算总结并在迭代表上提交另一个匿名估算。

（7） 重复步骤（4）～步骤（6），直到最低估算和最高估算一致。

一个典型的估算模型是通过对以前的软件项目中收集到的数据进行回归分析而导出的。这种模型的总体结构具有下列形式。

E=A+B * (ev) C

式中，A、B和C是由回归拟合导出的常数，E是以人月为单位的工作量，而ev则是估算变量（LOC或FP），例如，Walston- Felix模型。

E=5. 2 *  (KLOC) 0.91

#### 4.2 代码行估算方法

代码行（LOC）估算法是最基本、最简单的软件规模估算方法，应用较普遍。LOC指所有可执行的源代码行数，包括可交付的工作控制语言语句、数据定义、数据类型声明、等价声明、输入/输出格式声明等。代码行常用于源代码的规模估算，一代码行的价值和人月均代码行数可以体现一个软件组织的生产能力， 根据对历史项目的审计来核算组织的单行代码价值。

但同时，优秀的编程技巧、高效的设计能够降低实现产品同样功能的代价，并减少LOC的数目，而且LOC数据不能反映编程之外的工作，如需求的产生、测试用例的设计、文档的编写和复审等。在生产效率的研究中，LOC又具有一定的误导性。如果把 LOC和缺陷率等结合起来看，会更完整些。

有些公司会直接使用LOC数作为计算缺陷率的分母，也有一些公司会使周归一化（基于某些转换率的编译器级的LOC）的数据作为分母。因此工业界的标准应当包括从高级语言到编译器的转换率，其最著名的是Jones（1986）提出的转换率数据。如果直接使用LOC的数据，编程语言之间规模和缺陷率之间的比较通常是无效的。所以，当比较两个软件的缺陷率时，如果LOC、缺陷和时间间隔的操作定义不同则要特别地小心。

当开发软件产品第一个版本时，因为所有代码都是新写的， 使用LOC方法可以比较容易地说明产品的质量级别（预期的或实际的质量级别）。然而，当后期版本出现时情况就变得复杂了， 这时候既需要测量整个产品的质量，还要测量新的部分的质量， 后者是真正的开发质量——新的以及已修改代码的缺陷率。为了计算新增和修改部分代码的缺陷率必须得到以下数据。

•LOC数。产品的代码行数以及新增和修改部分的代码数都必须可得。

•缺陷追踪。缺陷必须可以追溯到源版本，包括缺陷的代码部分以及加入、修改和增强这个部分的版本。在计算整个产品的缺陷率时所有的缺陷都要考虑；当计算新增及修改部分的缺陷率时，只考虑这一部分代码引起的缺陷。

这些任务可以通过像CVS这样的软件版本控制系统/工具来实现，当进行程序代码修改时，加上标签，系统会自动对新增及已修改代码使用特殊的ID及注释来标记。这样，新增以及修改部分的LOC就很容易被计算出来。

#### 4.3功能点分析方法

功能点分析法（FPA）是在需求分析阶段基于系统功能的一种规模估算方法，是基于应用软件的外部、内部特性以及软件性能的一种间接的规模测量，近几年已经在应用领域被认为是主要的软件规模估算方法之一。

它从系统的复杂性和系统的特性这两个角度来估算系统的规模，其特征是：“在外部式样确定的情况下可以估算系统的规模”“可以对从用户角度把握的系统规模进行估算”。功能点分析方法可以用于需求文档、设计文档、源代码、测试用例等的估算。根据具体方法和编程语言的不同，功能点可以转换为代码行。

功能点分析的计数就是依据标准计算出的系统中所含每一种元素的数目。

•外部输入数：计算每个用户输入， 它们向软件提供面向应用的数据。输入应该与查询区分开来，分别计算。

•外部输出数：计算每个用户输出（报表、屏幕、出错信息等）。它们向软件提供面向应用的信息。一个报表中的单个数据项不单独计算。

•内部逻辑文件：计算每个逻辑的主文件，如数据的一个逻辑组合，它可能是某个大型数据库的一部分或是一个独立的文件。

•外部接口文件：计算所有机器可读的接口，如磁带或磁盘上的数据文件，利用这些接口可以将信息从一个系统传送到另一个系统

•外部查询数：一个查询被定义为一次联机输人，它导致软件以联机输出的方式产生实时的响应。每一个不同的查询都要计算。

#### 4.4 标准构件法

软件由若干不同的“标准构件”组成，这些构件对于一个特定的应用领域而言是通用的。例如，一个信息系统的标准构件是子系统、模块、屏幕、报表、交互程序、批程序、文件、代码行以及对象级的指令。项目计划者估算每一个标准构件的出现次数， 然后使用历史项目数据来确定每个标准构件交付时的大小。为了说明这点，我们以一个信息系统为例。

计划者估算将产生10个报表，历史数据表明每一个报表需要 600行代码。“这使得计划者估算出报表构件需要6000行代码。对于其他标准构件也可以进行类似的估算及计算，将它们合起来就得到最终的规模值，最后可以根据数理统计方法，对结果进行调整。

#### 4.5综合讨论

从估算方法来看，软件规模估算主要采用分解、对比和经验等各类方法，但更多的时候是将这些方法结合起来使用。分解的方法包括纵向分解和横向分解。

•纵向分解是在时间轴上对项目进行分解，也就是将整个项目过程分解为子过程（阶段），然后再分解为更小的活动或任务。纵向分解方法是基于过程的估算方法。

•横向分解是针对软件产品（或系统）来进行分解，将产品进行模块、组件或功能方面的分解，包括WBS方法、功能点方法和代码行方法等。

一般在项目层次上，项目与项目之间缺少可比性，但在模块或组件层次上、阶段性任务上具有可比性，可以基于历史数据来进行比较获得数据。所以，在实际估算工作中，一般先采用分解的方法，将项目分解到某个层次上，然后再采用对比分析方法和经验方法。

### 工作量估算

工作量估算的方法比较多，一般可以根据**历史数据**和**软件规模**估算的结果进行估算。例如，可以采用经验估算法、对比分析法和WBS法等进行估算。在采用这些方法时，也要小心对待。例如，在采用对比分析法时，如果新项目的预计代码行数是某相似的历史项目的2倍，则假设新项目的工作量也是上一个项目的2倍。

但实际上，这样按比例计算也不准确，一是代码行数翻一倍， 因为复杂性增强，工作量可能是3倍或4倍，不一定是2倍；二是项目虽然相似，但还是存在差异，这种差异没有在方法中体现出来。因此根据比例法得出的估算结果，还需要根据开发人员的经验进行调整。

软件项目估算永远不会是一门精确的科学，但将良好的历史数据与系统化的技术结合起来能够提高估算的精确度。

#### 5.1 COCOMO方法

构造性成本模型（Constructive Cost Model，COCOMO）方法是一种精确、易于使用的基于模型的成本估算方法，最早由勃姆（Boehm）于1981年提出。该模型按其详细程度分为3级。

（1）基本COCOMO，是一个静态单变量模型，它用一个以已估算出来的源代码行数（LOC）为自变量的函数来计算软件开发工作量。

（2）中间COCOMO，在用LOC为自变量的函数计算软件开发工作量的基础上，再用涉及产品、硬件、人员、项目等方面属性的影响因素来调整工作量的估算。

（3）详细COCOMO，包括中间COCOMO的所有特性，但用上述各种影响因素调整工作量估算时，还要考虑对软件工程过程中分析、设计等各步骤的影响。

COCOMO方法具有估算精确、易于使用的特点，在该模型中使用的基本量有以下几个。

•源指令条数（DSI），定义为代码行数，包括除注释行以外的全部代码。若一行有两个语句，则算做一条指令。KDSI即为千代码行数。

•MM（估算单位人月）表示开发工作量。

•TDEV（估算单位为月）表示开发进度，由工作量决定。

COCOMO方法重点考虑15种影响软件工作量的因素，并通过定义乘法因子，准确、合理地估算软件的工作量，这些因素主要分为以下4类。

（1）产品因素，包括软件可靠性、数据库规模、产品复杂性。

（2）硬件因素，包括执行时间限制、存储限制、虚拟机易变性、环境周转时间。

（3）人的因素，包括分析员能力、应用领域实际经验、程序员能力、虚拟机使用经验、程序语言使用经验。

（4）项目因素，包括现代程序设计技术、软件工具的使用、 开发进度限制。



#### 5.2 多变量模型

1978年Putnam提出的模型是一种动态多变量模型，它假设了在软件开发项目的整个生命周期中的一个特定的工作量分布，该模型是根据4000多个软件项目的历史数据统计推导出来的。Putnam模型可以导出一个“软件方程”，把已交付的源代码行数与工作量和开发时间联系起来。

#### 5.3 基于用例的工作量估计

用例在UML中被定义为“一个系统可以执行的动作序列的说明”，其中这些动作与系统参与者进行交互。用例图由参与者 （Actor）、用例（Use Case）、系统边界和箭头组成，用画图的方法来完成。用例描述则具体说明用例图中的每个用例，用文本文档来描述用例图中用箭头所表示的各种关系，包括泛化、包含和扩展等。

业务规则也应该纳入到用例中以便约束参与者的行为。例如， 在一个在线订单处理系统中，可能会设定一条规则——订单金额超过100元，即可免运费。而用例还可以分为外部用例和内部用例。例如，系统由子系统组成，那么描述系统及其参与者的用例， 相对子系统来说，是外部用例；而描述子系统的用例，相对于系统来说则是内部用例。

通过用例来描述系统的需求更清楚，不仅知道哪些任务要完成，而且任务之间的关系也比较明确。可能的话，可以在功能点和用例之间建立良好的映射关系，项目的估算会更准确。

#### 5.4 IBM RMC 估算方法

RMC（Rational Method Composer）的工作量估算功能采用的是定量影响因子估算方法和自底向上估算模式，让项目经理或者过程工程师对项目的任务、活动、阶段、子项目、项目等进行自底向上的层层估算。

在RMG中，我们可以定义多个估算模型，每种估算模型代表着一种不同的估算方法。每个估算模型可以定义任意数量的估算因子，估算因子用来表示某个因素对完成一个任务或活动所需工作量的影响程度，如以下两个估算模型。

•用例估算模型：使用用例的数量和复杂度来估算工作量。它包含的估算因子可能有复杂用例、 简单用例等。

•多因素估算模型：使用一个项目的多个方面来估算工作量。它包含的估算因子可能有业务领域、平台、类、用例等。

#### 5.5 扑克牌估算方法

扑克牌故事方法来自于敏捷实践中，基本的做法就是团队中三、四个人坐在一起，针对某个任务进行估算，将估算的结果通过特制的扑克牌表示出来，即选出代表自己估算值的纸牌，然后根据所出牌的数字（个人估算结果）进行比对，差异最大的两个人需要说明估算的理由、依据等，其它成员也可以补充发言。然后，再出牌，再沟通，直到这几个估算结果基本一致为止，这个一致的结果就是该任务工作量的估算结果。

在实际工作中，可能很难达到完全一致，所以只要到了比较接近时（如最大差值不超过5个点）或进行了4轮出牌（估算）， 就可以终止该条目的估算，取大家估算值的平均值就可以了。

扑克牌估算方法，一方面吸收了专家估算方法。（Delphi法） 的部分实践，例如，多人估算比一个人估算会更客观、准确，可以根据多人的估算结果来获得某些开发任务的估算结果，但又不同于专家故事方法。在敏捷开发思想中，团队更了解自己要做的事，团队做出的估算可能比专家的估算更准确，由团队自己来估算，其估算结果会更好，也有利于团队做出承诺。

另一方面，敏捷强调沟通，所以在每次出牌后，需要阐述是如何做出估算的。但考虑工作效率，不需要每个人做出说明，而是让估算差异最大的两个人来说明，而且差异最大的两个人也确实能带来更多或更有价值的信息，如估算时间最少的人可能采用了最有效的编程方法或测试方法，而估算时间最多的人可能是最保守，更可能是考虑得更全面，考虑了更多的场景、条件。

为了做好估算，在大家出牌前，可以由产品负责人为大家讲解待估算的条目（product backlog中的项），使团队成员对该条目有完全的了解、无任何重大疑问。在估算过程中，为避免干扰估算结果，团队成员之间不可以互相商讨，出牌时也不可立即亮牌，而是等所有人出完牌，再亮出来。估算时，如果单张牌不能代表估算值，可以用两张牌组合起来，例如出2、8两张牌来代表10。

出牌时，最关键的是建立好参照系，即将大家熟悉、最简单的一个条目的工作量作为参考值，如它的估算值是“3”，这个3代表多大的工作量，其他条目的估算就是以这个条目作为基准来进行估算，确保各个条目的估算客观、合理，消除每个人的主观性。

#### 5.6 不同场景的估算法

在实际项目管理过程中，经常会有估算的需求，即在不同的阶段进行估算。企如前面所说，时间越早，估算越粗糙。随着时间推移，获得信息越多，估算越准确。在不同的阶段或不同的场合，估算的方法和技巧有些区别，甚至有比较大的区别。例如， 有时做一个全新的项目，没有历史数据，这时，详细了解项目的需求就显得非常重要。在需求分析清楚之后，可以将WBS方法和功能点方法结合起来，进行项目的估算。

在前面的方法中，较多地讨论了以源代码行为基础来进行工作量的估算。这类估算方法，贴近程序，使软件技术人员比较容易接受。但它也要以软件技术人员的生产力数据为估算基础，如每个开发人员平均每天完成60～90行代码，包括调试、单元测试和缺陷修正等工作。而估算代码行的基础还得归于用例的估计、 功能的详细分解，如将任务分解到一个人或者一个很小的团队可以执行的程度（颗粒度）。

1. 合同签订之前

合同未签订时，了解的需求比较有限，只能了解到项目的总体需求，如开发什么样的系统、大概有多少用户等。通过估算项目的工作量，可以了解开发的成本，从而给出合理的报价。

2. 基于WBS估算的多维验证

当我们获得类似项目的历史数据、软件生命周期的生产率数据（含管理工作量）和详细需求时，就可以从不同的路径来估算工作量，获得多个结果，这些结果可以互相印证，以发现估算过程中的不合理之处，使估算更准确。

3. 需求变更的工作量估计

软件需求经常发生变化，而在需求变更控制时，也要提交需求变更所带来的工作量，也就是要求为需求变更进行工作量估算。这种情景也经常碰到，有必要在这里进行讨论。需求变更常常发生在设计、编码阶段，这里以编码阶段发生需求变化的情景为例来完成工作量的估算。

### 资源估算

项目中的每项活动都需要耗费或占用一定的时间和资源。项目资源估算，是指通过分析和识别项目各项活动的资源需求，确定出项目活动需要投入的资源种类（包括人力、设备、场地、材料、资金等）以及资源投入的数量和资源投入的时间，从而制定出活动资源需求列表。常用的活动资源估算方法，也包括专家经验）估算法、基于历史数据的类比法等。资源估算一般采用自下而上模式，即项目工作范围得到彻底的分解之后，由底层开始估算，然后再逐层汇总得到资源估算结果。

有时，人数是一定的，暂时没有资金招到新人或在短时间内很难招到合适的人员，这时，人员的估算就没有必要，所有的人都进入项目。在这种情形下，工作量的估算是最重要的，然后根据工作量和人数，来决定（估算）项目的进度。当然，多数情况下，假定有足够的资源，应根据项目的工作量估算、工作范围或项目周期来估算资源。所以，资源估算一般有以下两种情形。

（1）根据工作范围（WBS的分解结果），而不是工作量来进行资源估算，先分析多少人数是最合适或最有效的，然后确定所需资源。这种方法假定软件开发产品发布时间的限制较小，即软件开发组织在软件发布时间上自主性很强，从而强调开发效率（生产力）。

（2）根据工作量和软件产品发布时间的限制，估算需要的人数。在市场压力比较大的情况下，人们往往不得不采用这种方法。

1.根据WBS进行估算

根据WBS的分解结果来估算资源，主要是一些独立的工作应该由独立的人员去完成，而减少人员沟通成本，减少人员之间的依赖性，并使人员的经验和特长得到发挥，力求达到最高的工作效率。

2.由工作量和开发周期来估算

由工作量和开发周期来估算所需的人力资源，简单的估算公式如下：

**人员数量（人）=工作量估算（人日）/工期估算（日）**

3. 资源特征描述

每一类资源都可以用4个特征来描述：资源描述、可用性说明、需要该资源的时间及该资源被使用的持续时间。资源的可用性必须在开发的最初期就建立起来，包括人力资源、软硬件和可复用的构件资源等。针对人力资源，需要描述其具体的能力和经验，以及在该项目的开始时间和持续工作时间；而对软硬件资源， 需要考虑是否购买、租借等情形。如果需要购买，要清楚描述供应商、谈判时间、购买周期和安装完毕的期限等内容。

4.将资源分配给任务

通过对项目网络中所有活动资源分析，可以建立资源需求列表。下一步就是将资源分配给各个任务。在进行资源分配的时候， 要对资源的可支配时间进行充分的考虑。根据可支配时间的不同， 资源一般可分为以下几类。

•完全可分配资源，一般是指项目组内成员，他们的时间全部可以由项目经理来支配，但是要注意不能过度分配。

•外部资源，指项目外非直接可支配的资源，如外租借设备， 可支配时间就是租赁期。

•多项目资源，即多个项目共享的资源，如两个不同的项目组共享一个服务器进行测试，这样就要协商分配好各个项目组的使用时间。

•特殊技能资源，如聘请的外部专家的可支配时间就是聘用期，同时还要去掉他们节假日的时间。

•备用资源。如开发和测试的备份环境，这类资源要考虑的就是定期维护的问题。

5.项目角色

根据项目的目标可以确定项目管理所需要的工作特征和技能， 从而确定角色及其责任，明确各角色之间的从属关系，进行项目人力资源的预估。

（1）列出完成项目所需要的、主要的软件工程任务。

（2） 把适合于同一角色的任务集合到一起。

（3）对工作量、所使用的工具以及每个角色的重要性进行评估。

（4） 确定每个角色所需要的个人技能。

6. 人员分配

项目管理人员常常认为应该根据每个人的技能，而不是是否空闲来分配工作，这在理论上是对的。但是，这经常是不现实的， 除非资源非常多。因此，在进行人员分配时，最好考虑如下几个问题。

•谁最有能力来完成这项任务。

•谁愿意来完成这项任务。

•谁有时间来完成这项任务。

7. 人月神话

如果某个项目的估算结果是项目大概需要30人月来完成，看似结果很明确，但是，对这个结果的理解可以有很多种，例如：

•1个人做30个月

•3个人做10个月

•10个人做3个月

•30个人做1个月

看起来，上述工作量是等同的，怎样安排都可以，都是30人月。实际上，这个项目的真正解决方案可能是“5个人做6个月”， 这样效率高，任务好安排，责任明确，项目按时完成的把握很大， 顺利的话，可以提前完成项目；然而，“3个人做10个月”或 “10个人做3个月”就不是很好的安排，任务安排稍微有点难度， 周期也稍长一些或沟通成本增大，但基本可以接受；

而“30个人做1个月”肯定不行，需求调研不是由我们决定的，受用户制约太大，肯定来不及，设计、测试等时间也很难保证，任务协调、人员沟通成本太大，资源浪费，项目至少需要2 个月；“1个人做30个月”，周期太长，客户肯定不能接受，而且也找不到一个全才，能把所有的事情搞定。所以人与月之间是不能等同换算的。

《人月神话》一书中特别强调，用人作为衡量一项工作的规模是一个危险和带有欺骗性的神话。因为人之间是有差异的， 所以在确定人力资源的时候不仅要根据项目的缓急轻重来合理安排人力资源，而且要根据项目规模、独立工作任务的多少来安排合适的人（数），避免带来不必要冲突和浪费。同时人力资源也是最活跃、最灵活的部分，人员不像设备、材料只是被动地被调用，人有主观能动性。所以在分配人员的时候，要考虑更多的因素：技术、经验、沟通、协作和激励等。

### 工期估算和安排

为了制定项目进度计划，必须将项目各项活动分布在时间表上，形成进度表。项目进度表的制作需要计划项目每一个活动的开始时间和结束时间，即项目活动的历时也叫工期。进度表通过活动的相关资源和工期估算来构建，工期估算直接关系到各项活动、各个模块网络时间的计算和完成整个项目任务所需要的总时间。进度表是任务进度跟踪的基线，基线不对，就谈不上跟踪、 监督和控制，整个进度计划就如同纸上谈兵，不具有任何价值。

理想情况下，可以根据项目工作分解表来安排合适的资源， 即获得最高效率的人员配备，然后再决定项目日程，即先人力后日程。但在实际工作中，也常常存在相反的过程，即先日程后人力。由于市场决定业务，业务决定研发，所以一个新产品的上市时间往往由市场决定，需要从上市时间来反推出软件项目的各个日程。确定了日程之后，再根据工作量来决定所需要的人力资源。

#### 7.1 工期估算方法

项目活动工期估算常用方法也是专家（经验）估算法和基于历史数据的类比法。当项目获得足够信息时，采用类比法比较好， 而当项目获得的信息有限，难以采用类比方法时，可以采用专家估算法。

当我们面临有高度不确定性的任务时，我们可以采用三点估算法来进行工期估算。三点估算法就是对每项工作的工期给出3 种预估值——**最可能时间、最乐观时间和最悲观时间**，然后加权平均计算出其计划时间。

•最可能时间——T可能：根据以往的直接经验和间接经验， 这项工作最有可能用多少时间完成。

•最乐观时间——T乐观：当一切条件都顺利时该项工作所需时间。

•最悲观时间——T悲观：在最不利条件（各项不利因素都发生）下，该项工作需要的时间。

则计划时间的计算公式如下：

计划时间=（T乐观+4XT可能＋「悲观）/6

在常规的软件项目中，一般都使用类比和专家评定结合的方法，这样估算比较准确和可靠。如果有更好的新方法，我们可以尝试在项目中使用，也可以用其他办法实施。但是，绝不能拍脑袋估算基本不加分析，看了任务/活动就凭感觉来估算。工期估算中还要预留一定的比例作为冗余时间以应付项目风险。随着项目进展，冗余时间可以逐步减少。

在分析标识项目活动的时候，活动资源和历时的分析其实是同时进行的。“当一开始分析项目活动的时候，很难对于需要的所有资源和活动的工期有一个全面准确的估计，这就需要对资源和工期的估算进行反复的细化和调整。即使在项目实施中，也要结合实际情况对项目资源和工期进行适当的调整。

7.2 特殊场景

有时，市场决定了软件发布日期，进度无需估算。也有的时候，对于发布服务包（Service Pack，SP）或补丁包，周期是确定的，如每个月发布一次SP、每两周发布一次补丁包。当软件开发的时间已确定时，无需估算周期，主要任务是确定人力资源或要做的事情（开发任务）。

多数情况下，可能会由工作量和进度来估算人力资源，但还是会有根据工作量和人力资源来估算进度的时候。当我们有了工作量估算之后，可以简单地利用下面的公式获得工期估算。

工期估算（日）=工作量估算（人日）/人员数量（人）

 这是最简单的算法，同时也隐藏着很大的风险，因为它包含了以下两个假定。

•认为每个人的能力比较接近，实际上，每个人的能力相差比较大。

•认为人员足够多，项目周期就可以足够短。

所以要对每个人的能力进行分析，确定他们自己的等价关系， 这样，“人员数量”不是人员的自然数量，而是更客观反映人力的等价数量。

在实际使用历史数据估算法时，组织应建立一个历史项目数据库，包含以前所有项目的开发周期、项目规模、开发人员状况、 客户状况等详细数据。同时，基于该数据库，提供强大的数据查询、统计功能。这样，不仅容易搜索到最类似的历史项目，而且容易比较两个项目的不同和相同之处，做出更准确的估算。有了统计功能，也可以计算出某类项目或某类构件的参数平均值，为估算提供更可靠的参考数据。

### 成本估算

软件项目的成本估算大约开始于20世纪50年代的第一个大型程序设计项目，60年代，估算往往过于乐观，结果费用大大超支， 70年代以后，费用估算才引起人们的普遍重视。

精确的成本预算是项目控制的生命线，也是衡量项目是否获得成功的重要依据之一。为了完成项目的预算和成本控制，首先就需要完成成本估算，也就是对项目可能发生的费用进行估算。

在上一章3.5.5小节中，我们已讨论了直接成本和间接成本的组成，这里主要是讨论直接成本的估算，主要是人力成本的估算。人力成本可以用下列简单公式进行计算。

**人力成本估算（元）=工作量估算（人日）X单位平均成本 （元/人日）**

为了有效地控制风险，除了给出成本的估算值之外，还可以适当给出成本的浮动范围。例如，由于引入了新的技术可以提高工作效率，从而成本可能比经验数据少10%。但新的技术也带来了新的风险，如果不能很好地控制风险，则成本可能增加10%， 如果根据经验得出项目的成本预算为10万元，则浮动范围可以设定为9万元～11万元。这样，项目经理就可以更好地控制项目预算和风险。

#### 8.1 成本估算方法

在成本估算中，同样可以使用专家评估法、经验法、比例法和WBS方法等。分解方式可以根据项目情况来定义，常见的有基于模块估算、基于功能点估算、基于过程估算、基于用例估算和基于代码行估算等。WBS成本估算分为自上而下、自下而上和差别估计法等估算方法。

（1） 自上而下的估算是高层和中层管理人员根据以往的经验和个人的判断，估算出整体的项目以及各个分项目的成本。然后，这些成本估算被传达给下一级的管理人员，并由他们继续将预算细分下去，为分项目的每一项任务和工作包估算成本。自上而下进行估算的一个优点就是整体的成本预算可以得到较好的控制，然而该方法过多地依赖于高层经理的个人经验和判断。

（2）自下而上估算是将项目任务分解到最小单位工作包，对项目工作包进行详细的成本信算，然后通过各个成本汇总将结果累加起来，得出项目总成本。这种估算方法最大的优点是在具体任务方面的估算更加精确，因为第一线的工作人员往往会对具体任务有着更为准确的认识。但是在对单个任务的成本进行估算时，可能会忽视其他任务的影响。

（3）差别估计法。这种方法综合了上述两种方法的优点，其主要思想是把待开发的软件项目与过去已完成的软件项目进行类比，从其开发的各个子任务中区分出类似的部分和不同的部分。类似的部分按实际量进行计算，不同的部分则采用相应方法进行估算。

其实在评估软件成本的时候，往往是多种方法混合应用。因为软件项目的类型和开发环境各不相同，单一的评估方法是不能解决实际问题的。在评估成本的过程中，还要注意着重考虑下面几个方面，这些都是经验的总结，值得借鉴。

•在做成本估算的过程中，要紧密结合项目进度计划。

•避免过于乐观或者过于保守的估算。过于乐观的估算会导致项目先松后紧，不利于项目的成本控制，可能会带来成本超支。过于保守的估算可能导致管理层会压缩开支，对项目的开展不利。这两种估算都比较极端，要折中考虑才行。

•在费时较长的大型项目中，还应考虑到今后的职工工资结构是否会发生变化，设备费用以及管理费用在整个项目寿命周期内会不会变化等问题。

•在有新员工的项目中，还应考虑其培训成本。

•受软件开发行业特殊性的影响，人力资源成本是随着团队开发速率的变化而变化的。如果长期跟踪过一个团队的开发速率， 就会发现一些规律。在新团队开发开始工作的时候，团队开发速率很低，但会慢慢地成长。到达一定时间后，就会稳定在一个固定值附近。有时候有新的成员加入团队，团队的开发速率会出人意料地降低一段时间再慢慢回升。

#### 8.2 学习曲线

在软件开发项目中，谈到估算成本问题就不得不提及学习曲线（Learning Curve）。学习曲线（Learning Curve）是表示单位产品生产时间与所生产的产品总数量之间关系的一条曲线。它通常被应用于成本估算。不同的项目有不同的学习曲线。通常情况下，软件项目组在接到类似的软件项目后，第2次会比第1次节省15%~20%的时间。如果项目组接到一个新项目，软件工程师在以前项目中积累的知识经验常常就会无法延续，而导致项目人员进入这个新项目常常要经历很长的学习时间。

对于新加入项目的成员，也或多或少要经历一段时间的学习。图4-11是某一软件产品的学习曲线。在刚接触新的软件产品开发时， 由于没有经验和储备的技术不足，导致开始开发产品时其单位成本呈现上升的趋势。

随着开发产品数量或者产品规模的增大，经验和技术也相对

积累成熟，单位开发成本就呈现逐步下降的趋势。当然，也不能指望单位成本无限降低下去，那是不现实的。实际上当单位开发成本下降到一定程度后，就会稳定下来，不再继续变化，除非有特殊情况，如新技术的应用、产品功能改进等。

软件行业是一个技术更新很快的知识产业，夸张点形容，可以称得上是日新月异。所以，开发软件产品的学习曲线也是不断变化的。了解学习曲线的原理，尽可能地缩短学习曲线的不稳定期，降低软件产品的成本。可以通过知识分享，参考前人经验， 来缩短学习曲线的不稳定期。缩短学习曲线的不稳定期没有什么特效的方法，重要的还是靠自己的学习、思考、积累和总结。在学习过程中，要不断地把理论和实践相融合，“知其然更知其所以然”，这样才能提高得更快。

近几年，在进行软件成本估算时，学习曲线开始越来越受重视。在进入一个新项目时，软件开发人员需要用一定的时间去掌握有关的知识和技能，而每次完成同一性质的工作后，下次完成该性质的工作或生产单位产品的时间将减少，这就是学习曲线的主要内涵。随着对项目的逐渐熟悉，项目人员的绩效将得到改善， 从而项目成本也将降低。

