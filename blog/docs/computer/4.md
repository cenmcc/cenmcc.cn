# 第四章 局域网技术

### 局域网

- 概念：局域网是计算机网络的一种具体应用形式，也是互联网的重要组成部分。局域网可以将范围在几十米到几干米内的计算机设备连接起来实现数据的高速通信。可以实现文件管理、应用软件共享、打印共享和电子邮件等功能。网络中的用户可以通过局域网接入Internet。

- 发展过程：

  1. 20世纪70年代初，出现了不同的局域网技术，IBM公司设计的令牌环网，通用汽车公司的令牌总线网等。
  2. 1975年，美国施乐公司（Xerox）研制出了基于总线的以太网 (Ethernet)。
  3. 1980年，DEC公司、Intel公司和施乐公司联合提出了以太网标准DIX Ethernet V1
  4. 1982年提出了DIX Ethernet V2。

  局域网技术主要有以太网、令牌环网和令牌总线网3种。

  **现在的局域网技术主要是以太网**。

- 局域网的标准化：为了解决局域网技术标准化的问题，美国电气和电子工程师协会（IEEE）在1980年成立局域网标准委员会，简称IEEE 802 委员会，专门从事局域网标准化工作，IEEE 802标准主要研究的是局域网内部的数据传输与控制，对应**OSI参考模型的数据链路层和物理层两个层次**。数据链路层用于信息帧的传送与控制，物理层负责物理连接和实现比特流的传输。

- IEEE 802委员会提出将数据链路层划分为两个子层：**逻辑链路控制子层LLC**和**介质访问控制子层MAC**。接入各种传输介质有关的内容都放在MAC子层，包括将上层数据封装成帧进行发送、寻址和比特差错检测等。LLC层负责与介质接入无关的内容，包括建立和释放数据链路层的逻辑连接、提供帧序号、提供高层接口和差错控制等。不同的局域网产品在MAC子层和物理层可以采用不同的技术和协议，但在LLC子层必须采用相同的技术和协议。（当前全部使用以太网代替LLC）



#### IEEE系列标准

- IEEE 802.1AB：概述及网络体系结构，网络管理和网际互联 
- IEEE 802.2：逻辑链路控制协议LLC
- **IEEE 802.3**：MA/CD介质访问控制方法和物理层技术规范（**以太网**）
- **IEEE 802.4**：令牌总线介质访问控制方法和物理层技术规
- **IEEE 802.5**：令牌环介质访问控制方法和物理层技术规范 
- **IEEE 802.6**：城域网访问控制方法和物理层技术规范（MAN） 
- IEEE 802.7：宽带技术
- **IEEE 802.8**：光纤技术（FDDI）
- IEEE 802.9：综合话音数据局域网（ISDN）
- IEEE 802.10：局域网安全技术（Virtual LAN）
- **IEEE 802.11**：无线局域网介质访问控制方法及物理层技术规范 CSMA/CA ( WLAN)
- IEEE 802.12：新型高速局域网
- IEEE 802.15：近距离无线个人网络
- IEEE 802.16：宽带无线网络



### 以太网

- 以太网的技术规范：拓扑结构、传输介质、介质访问方式、传输速率、最多工作站数和最远传输距离等

- 工作原理：将收到的帧对照转发表，找到则转发，咋不到就广播。

- 传统以太网：传统以太网，采用**总线型**拓扑结构，所有结点共享一条总线，一个结点以广播的方式发送数据，为了避免冲突，要使用介质访问控制协议CSMA/CD。

- CSMA/CD：载波监听多路访问/冲突检测

  - 基本思想：每一个结点在发送数据之前首先要检测总线上是否有其他结点发送数据。如果有，则暂时不发送数据，要等到信道变成空闲状态后再发送数据，边发送边监听，当发现总线有冲突时立即停止发送，等待一段时间，再发送。CSMA/CD的介质访问控制基本思想概括：<u>**“先监听，再发送；边发送，边监听”**</u>

- 以太网的硬件地址：IEEE802委员会为局域网设定了一套标识规则，即用一个**48bit二进制**作为局域网的全球地址，标识每一块局域网适配器 （网卡），MAC地址或者物理地址。

- 以太网的MAC帧格式

  字节 	6		6	    2	46～1500	   4

  ​	———————————————————————

  ​	｜目的地址｜源地址｜类型｜	数据	｜FCS｜

  ​	———————————————————————

  - 以太网的MAC帧格式有两种标准：**DIX Ethernet V2**标准和 **IEEE802.3标准**。
  - 区别：
    - 两者的帧格式基本相同，唯一的区别在于以太网V2帧中设置两个字节作为类型字段，用于标识上一层所使用的协议类型。
    - IEEE802.3帧定义这两个字节为长度或类型字段。当字段值大于0x0600时，表示类型；当字段值小于0x0600时，表示数据部分的字节数。
    - 目前使用最广泛的是以太网V2的MAC帧格式。
  - 帧长64-1518B，数据长度46-1500。MTU1500字节。以太网中凡是出现帧长小于64的帧，都是由于碰撞而产生的无效帧

- 以太网的产品类型

  1. 粗缆以太网10Base-5：传输介质50Ω粗缆，带宽 10Mbps，基带传输，单电缆长度500米，最多4个中继器，一条干线至多100个工作站。
     - 10表示信号在电缆上的传输速率是10Mbit/s
     - Base表示电缆上传输的信号是基带信号
     - 5表示每一段电缆的最大长度为500m
     - 当实践网络跨度超过500m时，需要采用中继器将信号放大并整形后转发出去
  2. 细缆以太网10Base-2：传输介质50Ω细缆，带宽 10Mbps，基带传输，单电缆长度200米，最多4个中继器，一条干线至多30个工作站。
     - 站点间最大的干线长度为200m
     - 采用T形连接器将站点与同轴电缆相连
     - 最多使用4个中继器连接5条干线
     - 最大网络干线长度为910m
     - 一条干线最多支持30个工作站。中继器相当于一个工作站
  3. 双绞线以太网10Base-T：非屏蔽双绞线，长度100米， 至多4个集线器。（T表示双绞线）
  4. 快速以太网100Base-T：帧格式不变，CSMA/CD。
  5. 干兆位以太网：帧格式不变，CSMA/CD。
  6. 万兆位以太网：帧格式不变，不支持CSMA/CD，只支持全双工传输方式。

- 以太网的扩展

  - **中继器和集线器**

    - 中继器常用于连接两个以太网网段，对衰減的信号进行整形放大，保持与原数据相同。

    - 集线器（Hub）是一种特殊形式的中继器，内部工作方式仍然是**总线结构**，对物理信号进行放大和转发（**向其他所有端口**）。可以通过多个集线器之间的级联，形成更大范围的以太网。

      **注意：中继器和集线器只是对物理信号整形，是物理层上的设备。**

      多级集线器构成的以太网仍然采用的是CSMA/CD协议，因此会在整个以太网范围内形成一个很大的**碰撞域（或冲突域）**，即在这个冲突域中，任意时刻只能有一个主机可以发送数据，否则就会发生碰撞。 

  - **网桥**

    工作在**数据链路层**的以太网扩展设备，用于连接少量的以太网网段（网桥一般设有2-4个接口），它根据MAC帧中的目的地址对收到的帧进行转发和过滤。网桥通过接口连接不同的以太网网段，其内部维护着一个用于转发MAC帧的数据库，称为**转发表**。当网桥收到一个帧时，并**不是向所有接口（与集线器比较）**转发此帧，而是对该帧进行读取，检查其目的地址，根据转发表将该帧转发到合适的接口，或者将其丢弃。

  - **以太网交换机**：以太网交换机也是工作在**数据链路层**的以太网扩展设备，也被称为第二层交换机端口。





#### 虚拟局域网（VLAN）

- 标准：**IEEE802.1Q中虚拟局域网**
- 概念：虚拟局域网（VLAN）是由一些局域网段构成的与物理位置无关的逻辑组，而这些网段具有某些共同的需求。每一个VLAN帧都有一个明确的标识符，可以指明发送这个帧的主机属于哪一个VLAN。采用虚拟局域网的方式可以不受物理位置的限制，以软件的方式划分和管理局域网中的工作组。
- 好处：
  - 在虚拟局域网中的每一个主机都可以收到同一个虚拟局域网内的其他主机所发出的广播；
  - 当一个主机向虚拟局域网内的其他主机发送数据时，该虚拟局域网外的其他主机不会收到其所发的广播信息。 
  - “抑制广播风暴”
- 划分虚拟局域网的方法主要有3种：
  1. **基于交换机端口的划分**
  2. **基于MAC地址的划分**
  3. **基于上层协议类型或地址的划分**
- 帧格式：IEEE802.1Q标准定义了以太网帧格式，即在一般以太网的帧格式中插入一个4B的标识符，称为VLAN标记，用来指明发送该帧的主机属于哪一个虚拟局域网。
- 虚拟局域网中继技术 VLAN Trunk：在交换机1和交换机2之间用一条链路级联，并将对应的端口设置为Trunk端口，这样就可以使两个交换机上处于同一个VLAN 的主机进行通信，即a1和b1之间，a2和b2之间，a3和b3之间。
- 交换机配置VLAN的基本命令
  - 创建和修改VLAN：enable-> configure terminal-> vlan 100
  - 删除一个VLAN：在全局模式下：no vlan 100
  - 将一个端口指定到某个VLAN：
    1. 首先进入接口模式：在全局模式下执行：interfece fa0/1
    2. 然后执行：switchport access vlan 100
  - 将端口从VLAN中移出
  - 显示VLAN信息：show vlan



### 无线局域网（WLAN）

- 无线局域网根据结构可以分为两大类：
  - **有固定基础设施**的无线局域网：有固定基础设施是指网络中已经预先存在了一批固定的数据处理和转发设备
  - **无固定基础设施**的局域网。：无固定基础设施是指网络中的每个成员者是对等的可移动设备。
- IEEE802.11在MAC层使用CSMA/CA协议：
  1. 采用“停止-等待”的可靠传输方式
  2. 采用“虚拟载波监听”机制
  3. 在信道从忙态转为空闲时，各个站点要执行“退避算法” 等待一个随机的时间段后再发送数据，减少碰撞的概率。
- IEEE802.11协议标准规定了WLAN的最小单位为**基本服务集 BSS**，其中包括一个AP和多个移动设备。在一个BSS内，各个移动设备之间可以通信，但如果要和本BSS之外的设备进行通信，则必须经过BSS内的AP。
- 无固定基础设施的无线局域网——自组网络（ad hoc netword） 自组网络没有上述基本服务集中的接入点 AP 而是由一些处于平等状态的移动站之间相互通信组成的临时网络。

